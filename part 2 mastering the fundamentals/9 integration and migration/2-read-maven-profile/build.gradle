def getMavenSettingsCredentials = {
    File mavenSettings = new File(projectDir, 'settings.xml')
    def xmlSlurper = new XmlSlurper()
    xmlSlurper.parse(mavenSettings) // 解释settings文件
}

task printAppServerHome {
    doLast {
        def env = project.hasProperty('env') ? project.getProperty('env') : 'dev'
        logger.quiet "Using environment '$env'"

        // load settings.xml
        def settings = getMavenSettingsCredentials()
        def allProfiles = settings.profiles.profile
        def profile = allProfiles.find { it.activation.property.name == 'env' && it.activation.property.value == env }
        def appServerHome = profile.properties.'appserver.home'
        println "The $env server's home directory: $appServerHome"
    }
}

wrapper {
    gradleVersion = '7.0'
}
